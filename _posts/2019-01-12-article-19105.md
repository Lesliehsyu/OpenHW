---
layout: post
title:  "一种三维空间降噪装置"
author: XUP-2019
categories: [ project, 2019competition ]
image: assets/images/2019_1_5/cover.jpg
---

![isolution]({{ site.baseurl }}/assets/images/all_white.jpg)


**李卓林，晁鹤，黄永庆，冯智睿**

**指导老师：马令坤**

**陕西科技大学 电气与控制工程学院**

&nbsp;

**概述**

&nbsp;

随着现代工业化进程的加快，噪声污染已上升为一个严重的环境问题，和水污染、空气污染、固体废弃物污染一起被称为当今的四大污染，引起了全球的关注。可以说日常生活中几乎到处都充斥着噪声，尤其像现在家庭中的各种家用电器如空调、洗衣机、冰箱等工作时都会产生噪声污染；工厂中的一些工业设备， 如切割机、通风管道、压缩机、发电机等在工作时也会产生大量的工业噪声。

这些设备与人们的生活息息相关，所产生的噪声也已严重危害到人们的健康。洗衣机的噪声通常在 42~70dB，空调和冰箱在 34~50dB，而工业噪声普遍都超过 90dB，最高可达 130dB。研究表明，人耳最高可以接受 70dB 的声音，超过

50dB 的噪声就会影响人的正常休息，长时间睡眠不足会导致人体正常的生理机能出现问题；若噪声达到 70dB 会影响人们之间的交流，并使人出现躁动不安情绪，降低工作效率；长期身处 90dB 以上的噪声环境找那个会损伤听力，并致使心脑血管等一系列疾病的发生；100dB 左右的噪声会使人头痛，严重时会引发暂时性耳聋；当噪声高达 140dB 就会引起人的眼球振动，导致视觉模糊，呼吸加速，血压升高，说话能力也受到影响。因此，对噪声污染的治理是一个急需解决的问题。

一般而言，解决噪声问题会从噪声的源头、传播途径和接收者三个方面入手。从原理上来分，进行噪声控制的办法主要包括无源(被动)控制(Passive Noise&nbsp;Control，PNC)和有源(主动)控制[1] (Active Noise Control，ANC)两种。无源控制是用声学方法来实现降噪目的，其机理是利用声学材料或声学结构特性，通过吸声处理、隔声处理、使用消声器、隔离振动等方法使声波在传输过程中相互作用消耗声能来降低噪声，但是该方法仅在降低中、高频噪声时效果比较好，对低频段噪声抑制效果不理想，并且实现起来体积庞大、价格昂贵。然而现在大多数家用电器和机械设备所产生的噪声都集中在低频段，且频率越低，声波波长越长， 穿透能力也越强，更易对人体造成危害。此时有源控制的出现可以很好地将以上问题解决。

有源噪声控制是将声学和电子装置相互配合，根据声波相消干涉原理，针对初始噪声，产生一个与其幅度相同、相位相反的次级噪声，两列声波在空间中互相叠加来降低噪声。由此可知，实现有源控制的核心技术是对次级噪声幅度和相位的调节[ 2-3] ，其核心思想如图 1-1 声波抵消图所示。与无源控制相比，该方法能很好地降低低频段噪声，并且实现简单、体积小、易于安装。

![image_1]({{ site.baseurl }}/assets/images/2019_1_5/image_1.png)



图 1-1 &nbsp;声波抵消图(空间中某点的压强随时间变化图)

&nbsp;

**主要创新点**

&nbsp;

低成本的非接触式宽带大范围主动降噪：以座椅为载体，嵌入噪声控制单元、机器视觉单元和运动控制单元，既避免了接触式降噪(降噪耳机)容易导致出汗、甚至损伤听力的缺陷，又避免了基于多扬声器的阵列降噪系统的高成本。以极低的成本满足了个人休息时的降噪需求。

&nbsp;

&nbsp;

**系统架构**

**1. 降噪处理单元硬件设计**

降噪处理单元核心为一个单核 ARM Cortex-M7 微控制器，组成硬件还包括自适应声音采集电路，扬声器驱动电路和滤波电路，如图 2-4 为它们的硬件组成框图。

![image_2]({{ site.baseurl }}/assets/images/2019_1_5/image_2.png)

图 2-4 &nbsp;硬件组成框图

**1.1&nbsp;传感器前置放大电路设计**

传感器在 ANC 系统中用来采集初级噪声和残余噪声，其本身的特性直接影响 ANC 算法的计算精度，进一步影响系统的降噪效果。在本次设计中考虑到需要在空间内采集噪声信号，为了方便安装和调整位置，选用了电容式咪头，该话筒指向性为心形指向，频响范围为 40Hz~18kHz，正好符合系统对低频信号的频响稳定度，输出阻抗为 600&Omega;，灵敏度为-40dB&plusmn;2dB，可承受的最大声压级为115dB，采集距离远，具有 20~50cm 的参考拾音距离。

本系统使用话筒来采集噪声以实现声电转换功能，但是由话筒采集转换的电信号比较微弱，通常在 mV 级水平，为了防止幅值太小而导致 A/D 采样位数的变化不大，需要将微弱的电信号放大到一定电平来得到合适的电压，供后续电路使用。由于本次采集的是语音信号，频响范围较宽，而放大电路在对有用信号进行放大的时候也会将噪声放大，因此该电路在设计时要保证自身噪声尽可能小， 输入阻抗足够大，输出阻抗足够小，才能够使信号在传输过程中失真较小，以保证信号的稳定性。本次设计选用 AD823 构成两级放大电路，一方面因为 AD823 是高性能低噪声双运算放大器，有良好的输出驱动能力和很高的小信号带宽，能够适用于各种音频放大领域；另一方面由于 AD823 可以采用 3.0V~36V 的单电源供电，当供电电压为 3.3V 时，能够与降噪处理单元核心的供电电压一致，这样不仅可以降低芯片功耗，还能减少电压路数。具体的电路设计如图 2-5 所示。

![image_3]({{ site.baseurl }}/assets/images/2019_1_5/image_3.png)

图 2-5 &nbsp;前置放大电路

该电路中 AD823 采用+3.3V 单电源供电，因此由稳压电路为其供电。其中R2 和 R6 构成第一级反相比例放大，放大倍数为 5.1 倍，R1 和 RP7 构成第二级反相比例放大，放大倍数为 50 倍，这样整个电路就会有 255 倍的放大区间，完全满足系统要求，可以通过调整滑动变阻器 RP7 来改变放大倍数，以得到实验时所需的电压。此外团队还设计了另一种自适应放大电路，以适用于不同噪声大小环境，如附录 I 所示。

**1.2 功率放大电路设计**

功率放大器在 ANC 系统中用来对控制器输出的信号进行放大以驱动次级扬声器发出次级噪声。它的选择要求其功率要和扬声器匹配，匹配时功放的功率要大于扬声器的功率。功放的阻抗也要和扬声器相匹配，当功放的额定输出阻抗与扬声器的额定输入阻抗相一致时，二者才能实现最佳匹配。如图 2-6 为 TDA7377 的电路图。

![image_4]({{ site.baseurl }}/assets/images/2019_1_5/image_4.png)

图&nbsp;2-6 功放电路

TDA7377 是采用了新技术的AB类音响放大器。可以使用双桥接输出到两个喇叭上，或者非桥接四单端输出到四个喇叭。专业的完全互补输出结构和内部固定增益保证了在大功率下输出不失真，并且周边原件非常少，简化了电路。

经 ANC 算法处理输出的次级信号需通过 D/A 转换后连接至功放以驱动次级扬声器在误差传感器范围内产生次级噪声。但由于 D/A 输出受到系统采样率的限制，其输出的模拟信号会引入高频干扰，及声器发出的声音中还存在高频干扰会影响到最终的降噪效果，此时需要通过一个平滑滤波器来滤除高频噪声。而本电路设计原理图如图 2-7 所示。由线性稳压源供电，使用两级低噪声、高增益单片式运算放大器 TL082 构成四阶滤波器，其中第一级中 R1 和 C4、R2 和 C1 构成一个二阶滤波器，同样第二级中 R3 和 C2、R4 和 C5 构成另一个二阶滤波器。

![image_5]({{ site.baseurl }}/assets/images/2019_1_5/image_5.png)

图&nbsp;2-7 DAC&nbsp;输出滤波器电路

## **2. 降噪处理单元软件设计**

图 2-8 为系统软件结构框图。系统先进行初始化，然后执行进行次级通道辨识，辨识结束后进行主程序，用误差信号判断是否对噪声进行抵消。

在实际应用时，还需要根据控制器运算能力与实际降噪需要，预设一个系统采样率，每次采样完成后，利用 CPU 将采样结果归一化，再将归一化的采样值送入算法函数，运算结果去归一化送入 DAC。软件初始化流程如图 2-8(a)所示， 中断处理（降噪）如图 2-8(b)所示。

在本项目中，系统采样率为 28.6&nbsp;kHz，4 个次级通道阶数均为 128，2 个主通道阶数为 320，软件利用基 16 的 FIR 运算的作循环，并利用滚动储存方式提升系统运行效率。

综上，除 ADC、DAC，屏幕显示，按键处理，内存读写等其它时间开销外， 系统每秒所进行的浮点乘加运算超过 28.6 k * (128 * 4&nbsp;+ 320 * 2 * 3)&nbsp;= 69 M 次。

![image_6]({{ site.baseurl }}/assets/images/2019_1_5/image_6.png)

图 2-8 &nbsp;软件流程

&nbsp;

**设计演示**

&nbsp;

**1.&nbsp;次级通道离线辨识**

首先进行次级通道离线辨识实验，然后分别选用单频、多频和实际噪声进行降噪实验，评估降噪装置的降噪效果，并通过声压计实时监测环境噪声水平。

次级通道的辨识将影响到整体系统的收敛效果，本作品是使用带限白噪声进行辨识。

实验条件：关闭噪声源，降噪处理单元产生带限白噪声作为主信号，主信号通过 D/A 转换和功率放大驱动次级扬声器发声，用传感器采集该噪声作为参考信号，两路信号同时送入降噪处理单元内部并调用 LMS 算法经滤波处理产生输出信号，参考信号与输出信号的差值就是误差信号，经 LMS 算法调节后系统很快收敛，用示波器观察到误差信号减小了大约 10 倍，如图 5-1 所示。

![image_7]({{ site.baseurl }}/assets/images/2019_1_5/image_7.png)

图 5-1 &nbsp;次级通道离线辨识残余误差

使一位实验者坐于安装有实验降噪器的座椅上，打开降噪器并进入辨识模式，等待系统收敛后，可由计算机串口获得降噪器 4 个 128 阶的次级通道系数。

如图 6 所示，红、绿、蓝、紫四色线条，分别代表了四个次级通道模型，图中横坐标为模型阶次，纵坐标为该阶次对应的权系数。

![image_8]({{ site.baseurl }}/assets/images/2019_1_5/image_8.png)

图 5-2 &nbsp;次级通道建模结果

利用 MATLAB 自带的 FREQZ 函数对次级通道系数进行分析，可获得次级通道频域特性。图 5-3 展示了其中一个次级通道模型的频域特性，其它次级通道模型特性与此类似。

![image_9]({{ site.baseurl }}/assets/images/2019_1_5/image_9.png)

图&nbsp;5-3 次级通道模型S11(z)频域特性

由图 5-2 可知，次级通道阶数约为 100 阶，预设的模型阶数(128)能够满足实验要求。在图 5-3 中幅频特性曲线，以-3&nbsp;dB 线作为通带截止频率，可见降噪器仅能对 180Hz-1200Hz 的主滤波器输出做出响应， 即降噪器的降噪范围在180Hz-1200Hz 内。根据降噪器系统组成可知，频响下限主要由扬声器性能决定， 频响上限主要由 DAC 输出连接的低通平滑滤波器决定。

&nbsp;

**2. 人为噪声降噪结果**

测试人为噪声降噪效果的方法为：通过桌面版 Audio &nbsp;Sweep &nbsp;Gen &nbsp;软件与3.5mm 音频口连接外置低音音响，产生 200 - 800Hz 递增的正弦单频、双频信号以及 40 - 100Hz 方波噪声作为噪声源，进行降噪测试。

人为噪声中，正弦噪声可以检验降噪器的基本降噪能力，通过声压计观测到的单双频测试部分结果如表 1 所示。

表&nbsp;5-1 正弦噪声降噪结果

![insert_1]({{ site.baseurl }}/assets/images/2019_1_5/insert_1.png)

误差传感器在一次单频测试中的降噪效果如图 5-4 所示，图中，黄色波形是参考传感器采集到的信号，青色波形是左误差传感器采集到的信号，降噪器在图中的中间点打开。由图可见系统在启动后 150ms 内即达到降噪效果。

![image_10]({{ site.baseurl }}/assets/images/2019_1_5/image_10.png)

图&nbsp;5-4 单频降噪测试波形

方波噪声的谐波分量可以覆盖整个音频范围，通过方波可以测试系统对宽带噪声的降噪能力。如图 5-5 为 100Hz 的方波噪声频谱。

![image_11]({{ site.baseurl }}/assets/images/2019_1_5/image_11.png)

图&nbsp;5-5 100Hz&nbsp;方波噪声频谱

图 5-6 为了一次测试中误差传感器旁的残余噪声频谱，由图比例推算可知降噪器可以显著降低方波噪声中的低频噪声。同时也可看出，本不在降噪器降噪范围的高频噪声也得到了降低，这表明玻璃窗本身对于中高频噪声有一定的隔绝能力。

![image_12]({{ site.baseurl }}/assets/images/2019_1_5/image_12.png)

图&nbsp;5-6 100Hz&nbsp;方波残余噪声频谱

方波噪声的部分降噪结果如表 5-2 所示，由表可知降噪器对于方波噪声的降噪量在 2.7 ~ 7dB 之间。比起正弦噪声，方波噪声降噪量大幅降低的主要原因为： 系统响应范围决定了其对于低于 180Hz 的低频分量和高于 1200Hz 高频分量降噪能力有限，增大系统响应范围需要使用固有频率足够低的扬声器与运算足够快的处理器。

表&nbsp;5-2 方波噪声降噪结果

![insert_2]({{ site.baseurl }}/assets/images/2019_1_5/insert_2.png)

**3.&nbsp;&nbsp;实际噪声降噪结果**

降噪器对于机械旋转噪声与汽车鸣笛声的降噪结果如表 3 所示，由表可知降噪器对于几种实际噪声的降噪量在 5 ~ 10dB 之间。

表&nbsp;3 实际噪声降噪结果

![insert_3]({{ site.baseurl }}/assets/images/2019_1_5/insert_3.png)

降噪器在汽车鸣笛声降噪实验过程中波形如图 5-7 所示。图中，黄色波形是参考传感器采集到的信号，青色波形是左误差传感器采集到的信号。

![image_13]({{ site.baseurl }}/assets/images/2019_1_5/image_13.png)

图&nbsp;5-7 鸣笛声降噪测试波形

通过以上实验发现，本次所设计的三维空间降噪装置能够降低生活中机械设备所产生的低频噪声。虽然在有些高频分量处功率增大，但这部分功率密度较小， 不会影响整个系统的降噪效果；由于生活中的噪声成分更加复杂，降噪效果没有单频和多频好，不足 10dB，但同样可以验证该系统设计的合理性和有效性。在本次实验的基础上，还需要更多的研究空间中声场环境，并且对 ANC 算法提出更高的要求。
