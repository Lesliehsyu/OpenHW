---
layout: post
title:  "步行助力外骨骼机器人"
author: XUP-2019
categories: [ project, 2019competition ]
image: assets/images/2019_1_4/cover.jpg
---

![isolution]({{ site.baseurl }}/assets/images/all_white.jpg)

**孙定阳，何思宇，倪传政，周天林，段宝阁**

**指导老师：郭朝**

**武汉大学**

**概述**

步行助力外骨骼是一种穿戴在人体下肢的人机一体化机械装置。它的优越性在于能将支撑、运动、防护三项功能紧密结合，通过同步&ldquo;跟随&rdquo;人体运动，辅助人体负重行走，有效提升使用者的负载行动能力。在康复训练中它能够替代医疗人员进行繁复的康复工作，并能够提供精准的关节运动姿态和保护

国内下肢外骨骼系统的发展尚处于研究试验阶段，其技术难点在于外骨骼对于人体运动的顺应性即外骨骼机器人的柔性。针对上述问题，研发了一种步行助力外骨骼机器人，该机器人具有如下功能：<br />
（1）穿戴在人体腰部及下肢，可实现坐下/站起及负重行走。<br />
（2）膝关节机构能够模拟人体膝关节的变瞬心运动，具有更好的顺应性。<br />
（3）通过安装在人体的IMU系统及力传感器，可以实时检测人体步态、下肢姿态及人机交互力，实现人机协同控制。<br />
本文所研发的外骨骼机器人预期成果为：<br />
（1）设计膝关节变瞬心机构模拟人体膝关节的变瞬心运动；<br />
（2）采用绳驱动将驱动器和关节分开，减小关节质量和惯量，增加关节柔性；<br />
（3）设计基于IMU系统和力位信息的滑模控制器，实现外骨骼机器人的人机协同行走，可用于人体下肢康复训练。

&nbsp;

**主要创新点**

&nbsp;

根据该类机器人现状，考虑现有机器人的不足，本文研制了步行助力外骨骼机器人，主要完成以下内容：首先设计机器人结构和控制系统，其次分析正常人步行时的基本步态并通过IMU进行检测，再者完成基于力位信息的模糊滑模控制，接着进行机器人样机试验，最后总结。<br />
主要创新点如下：<br />
（1）设计膝关节变瞬心机构模拟人体膝关节的变瞬心运动；<br />
（2）采用绳驱动将驱动器和关节分开，减小了关节质量和惯量，增加了关节柔性；<br />
（3）设计基于IMU系统和力位信息的滑模控制器，实现外骨骼机器人的人机协同行走，可用于人体下肢康复训练。

## **系统架构**

&nbsp;

## **1. 步行助力外骨骼机器人设计需求与总体方案**

### **1.1 设计需求分析**<br />
（1）运动需求分析

![image_1]({{ site.baseurl }}/assets/images/2019_1_4/image_1.png)

## 图2-1 下肢解剖图

**本文研制的外骨骼机器人针对下肢步行助力及重量传递两种使用环境。在人前进过程中，下肢通过腿肌带动各关节的旋转，从而进行双腿的弯曲和伸直，人体整体始终处于平衡&mdash;&mdash;重心前移&mdash;&mdash;失衡&mdash;&mdash;支撑平衡的运动状态。因此人在运动过程中无论是慢走还是跑步都包含着抬腿与支撑两项助力项，对应着各关节的正逆旋转运动。下肢关节包含着髋关节、膝关节、踝关节，下肢结构解剖图如图2-1所示。步行需要全身的大部分肌肉共同配合才能实现。整个步行过程由重心的位移、骨盆翻转、髋关节、膝关节、踝关节的组合运动以及上肢的平衡调节运动组合而成⑯，从而实现人体的向前行走。人体的一个步态周期是指人在行走时一只脚的脚跟和地面接触到该脚的脚跟再次和地面接触的过程。根据上述人体运动学的分析，机器人的运动需要满足以下需求。**

1）机器人需要实现人体下肢步行时的基本运动，包括髋关节、膝关节及踝关节的运动，同时要进行关节运动限位以保障穿戴者的安全。<br />
2） 减轻外骨骼的质量与体积，轻量化外骨骼同时也是为了使外骨骼更加紧凑，提高控制的精确度和更优的人机交互性能。<br />
3）外骨骼机器人应具备一定的柔性，尽量顺应人体运动趋势，能实现各关节&ldquo;同步&rdquo;伴随运动，不应当产生阻碍运动，同时具备一定的缓冲性能。<br />
（2）控制系统需求<br />
本文设计的外骨骼机器人控制系统需求如下：<br />
1）步行轨迹：控制机器人完成模仿人体步态的步行运动<br />
2）人机交互：可以改变机器人的工作状态，对机器人的速度，步态相进行有效控制，并进行人机协同。<br />
3）步态检测：可以实时获取机器人和使用者所处的步态相和下肢姿态。<br />
4）系统可扩展性，兼容性：预留一定的接口方便其余子模块接入系统并且具有一定的兼容性。

### **1.2 外骨骼机器人总体方案**
外骨骼机器人系统的总体设计直接影响到机器人的使用性能和工作效率，需要以系统全面的观点来进行综合考虑。考虑到通信、能源供给等需求，本文的外骨骼机器人系统总体设计方案采用了无线式机器人设计方案。该方案的特点是：机器人采用无线作业方式，外骨骼机器人的能源供给通过随身蓄电池实现，运动控制以及陀螺仪信号的传输通过无线模块实现，并由后续仪器设备进行相应地处理。按照该方案，外骨骼机器人系统主要由外骨骼机器人本体、机器人控制系统、上位机等部分组成。<br />
（1）外骨骼机器人本体总体方案<br />
将髋关节、膝关节、踝关节进行关节模块化设计，使不同关节可以进行自由度的增减配置，同时可以方便对故障关节进行针对性修复及调试。每个关节模块由机械部分和控制部分构成。机械模块集成了Maxon伺服电机与编码器、陀螺仪、行星齿轮减速器、传动零件和零位开关；控制模块由驱动器、通信接口、传感器信号处理器和控制器组成。驱动器使用并行通信的方式与电机和编码器进行连接，机器人控制器通过CAN总线与驱动器连接，通过驱动电机带动关节运动；控制器获取机器人传感器信息，实时监控关节运动参数。<br />
1）自由度配置及关节限位

根据人体下肢运动机理的分析，将机器人的关节设置为髋关节三个自由度，膝关节一个自由度（电机驱动）以及踝关节两个自由度。同时由于膝关节的变瞬心运动特性，需要设计一种能够模拟人体膝关节运动特性的机构。另外为了人体关节运动的安全性和机器人的承重能力，需要在关节处进行限位。所有的机械限位均根据人体下肢各关节运动范围进行设计。<br />
2）柔性绳驱方案<br />
为了避免关节惯量过大，在膝关节采用绳驱动，将电机和减速器布置在大腿（后期置于腰部），通过鲍登线传递动力。采用该种驱动方式能够在有效降减小机械结构尺寸和降低复杂性的同时，提高机械系统的可靠性。<br />
3）人机连接方案<br />
人机交互是上肢康复外骨骼机器人系统的一个典型特征，人机交互的两个最主要的目标就是实现舒适性和安全性，安全性主要依赖机器人结构本身的限位以及机器人的运动控制等方面，舒适性在很大程度上依赖于穿戴者下肢和下肢外骨骼机器人的固定装置方案。本文为了减轻质量，采用单边固定形式，即外骨骼机器人与穿戴者下肢之间的约束形式为单边固定，这样的固定方式存在的缺点是上肢会相对机器人转动。为了解决该问题，设计弧形固定和多处固定，更容易和上肢紧密贴合。<br />
（2）外骨骼机器人控制系统方案<br />
为了满足控制系统需求，将控制系统划分为三个独立的工作层，三个工作层从高到低依次为人机交互层、主控层和功能层，后两层位于机器人移动载体中，不同层之间通过通讯来实现信息交换。三个工作层分别有如下特点：

![image_3]({{ site.baseurl }}/assets/images/2019_1_4/image_3.png)

图2-2 控制系统总体框图

1）人机交互层:人机交互层是控制系统提供给使用者的操作接口，操作者可以通过该接口对机器人进行模式设定、功能选择、数据显示等功能，同时可以获取机器人运动过程中反馈的各种信息。<br />
2）主控层:主控层主要包括两个方面：其一是作为人机交互层与功能层的信息桥梁，操作者的指令通过主控层传递给功能层，实现相应的动作；其二是为控制系统提供大量其他功能模块的接口。<br />
3）功能层:功能层是控制系统的核心，执行操作者相应的控制指令，包括对电机驱动器的控制、传感器信号的采集与处理等。<br />
机器人控制系统的总体框图如图2-2所示，人机交互层与主控层通过以太网或者无线通讯相连，系统在主控层与功能层之间采用基于CAN协议总线的通讯方式实现信息交互。


**2. 步行助力外骨骼机器人控制系统搭建**

**2.1 控制系统方案设计**

外骨骼机器人控制系统框图如图2-3所示，主要分为以下六个模块：<br />
1）驱动执行模块：驱动执行模块是实现运动控制的核心，为外骨骼机器人运动提供动力。对于本控制系统，驱动执行模块主要由电机、减速器、编码器和相应的驱动器组成；<br />
2）传感器模块：外骨骼机器人通过传感器模块检测机器人姿态信息和其所处步态相，为机器人各种运动控制策略的实现提供判断依据；<br />
3）控制器模块：各个工作层在其主控制器的控制下，通过信息交互实现系统对任务的综合协调与分配；<br />
4）上位机模块：实现人与机器人的信息交互以及操作者对机器人运动的有效控制，并时刻了解机器人的运行状态；<br />
5）供电系统：供电系统为控制系统中所有硬件的正常工作提供能量，为机器人运动的稳定性提供保障；

![image_4]({{ site.baseurl }}/assets/images/2019_1_4/image_4.png)


**设计演示**

## **1. 单关节空载实验**<br />
搭建完成后外骨骼机器人实验平台后，需要对外骨骼机器人基本运动功能进行测试，以检验实验平台运行的安全性和可用性，为此进行了外骨骼单关节运动测试，以及运动范围的测试, 如图5-1所示。<br />
检测外骨骼膝关节的运动范围，测试结果表明当穿戴外骨骼时的运动角度要小于人体膝关节运动极限，这样能够较好地保证穿戴者的安全。

![image_5]({{ site.baseurl }}/assets/images/2019_1_4/image_5.png)

![image_2]({{ site.baseurl }}/assets/images/2019_1_4/image_2.png)

## 图5-1 单关节空载摆动测试

## <br />
**2.&nbsp;人机固定轨迹跟随实验**<br />
固定轨迹是一个预先设定好的、与正常穿戴者动作相仿的运动轨迹。由于 助力外骨骼机器人也能够面向康复使用，因此有必要进行固定轨迹下的跟随实验，同时为了测试第四章所提出的模糊增益滑模控制，与一般的 PID 控制做对比。实验过程如图 5-2 所示，将下肢外骨骼机器人用架子挂起，穿戴者的一条腿穿戴好外骨骼，上电后随外骨骼腿进行固定轨迹的跟踪。

![image_6]({{ site.baseurl }}/assets/images/2019_1_4/image_6.png)

首先基于普通PID 算法对CGA 轨迹进行跟踪，实验完毕后，记录实验误差，分析实验数据

40.9cos(1.04t &minus;0.208)+157cos(5.82t &minus;0.047) +82.3cos(7.49t &minus;4.13) （5-1）

在该实验中，设置 PD 参数为K p = diag(50,50)，Kd = diag(50,50)。从图中可以看出，轨迹跟踪曲线与指令曲线基本吻合，这表明人体穿戴上外骨骼后仍能很好地实现预订轨迹的执行，证明 PID 控制方法在该系统中已经能够达到一定效果。但由于模型不精确、外界干扰大等因素，还是存在一定的误差，因此还需要进一步使用自适应算法进行跟踪。

![image_7]({{ site.baseurl }}/assets/images/2019_1_4/image_7.png)

如图5-3 所示，膝关节最大跟踪误差为2.35&deg;，由此看来应用普通PID 控制已经能够实现一定程度的估计跟踪，但是存在较大的跟踪误差。作为比较，我们使用所提出的模糊增益滑模算法进行轨迹的跟踪，跟踪曲线如图5.4 所示。在该实验中，设置滑模面参数为A= diag(50,50)，K =diag(100,100)。如图5-4 所示，膝关节最大跟踪误差为 0.86&deg;，由此可见，所提出的模糊增益滑模控制能够较大程度地降低跟踪误差，显示出对于较强的不准确模型参数的适应性，因此，最终实验结果证明所提出的模糊增益滑模控制策略在本系统的使用中非常有效，满足使用要求。

![image_8]({{ site.baseurl }}/assets/images/2019_1_4/image_8.png)

&nbsp;

**3. 基于力位信息控制的随动行走实验**<br />
基于第三章所提出的力位信息控制算法，对下肢外骨骼样机系统进行测试。实验人员穿戴好下肢外骨骼机器人，将膝关节调整至外骨骼关节旋转中心与人体旋转中心重合，穿戴者系紧肩带与腰封，并绑紧压力鞋绑带，启动电气开关，使用整个下肢外骨骼机器人上电，记录此时各传感器初始数据，行走过程如图5-5 所示。

![image_9]({{ site.baseurl }}/assets/images/2019_1_4/image_9.png)

通过电机编码器记录行走过程中髋关节及膝关节的位置、速度和控制力矩曲线，如图 5-6 所示。

![image_10]({{ site.baseurl }}/assets/images/2019_1_4/image_10.png)

从图5-6 (a)和(b)的关节角度曲线可以看出，HEXO 具有良好行进效果，行走过程比较平稳，其曲线与 CGA 曲线基本吻合。外骨骼机器人能够随穿戴者以较快速度行进，行进速度最高可达到 4km/h。从图 5-6(c)中可以看出，驱动关节的峰值力矩都 50Nm 左右，在驱动模块的承载范围之内，行进过程中阻力较小，穿戴者可以较轻松地完成行走动作。从图 5-6 (d)中可以看出，髋关节的最大功率在 140W 左右，膝关节的最大功率在 95W 左右，所使用的驱动电机的功率为150W，能够满足最大速度行进的要求。
